{% extends 'uploader/base.html' %}
{% block body_block %}
<div id="crumbs">
    <a href="{% url 'uploader:index' %}">Home</a> > 
    <a href="{% url 'uploader:subject' unit.syllabus.subject.slug %}">
        {{ unit.syllabus.subject.subject_name|truncatechars:45 }}</a> >
    <a href="{% url 'uploader:syllabuses' unit.syllabus.subject.slug unit.syllabus.exam_level.slug %}">
     {{ unit.syllabus.exam_level.level_name|truncatechars:45 }}</a> >
    <a href="{% url 'uploader:syllabus' unit.syllabus.subject.slug unit.syllabus.slug unit.syllabus.exam_level.slug %}"> 
     {{ unit.syllabus|truncatechars:45 }}</a> >
     {{ unit.title|truncatechars:45 }}
</div>
<h2>{% block head_title %}{{ unit }}{% endblock %}</h2>
{% if unit.description %}
<div id="description">
    {{ unit.description }}
</div>
{% if resources %}
<p>I found no unit topics linked to {{ unit }}, below are resources for this unit.</p>
<div id='resouce_list'>
  <ul>
    {% for resource in resources %}
      {% if resource.file %}
        <li data-type="file"><a href="{% url 'uploader:resource' resource.slug %}">
            {{ resource }}</a>
        </li>
        {% else %}
        <li data-type="bookmark"><a href="{% url 'uploader:resource' resource.slug %}">
            {{ resource }}</a>
        </li>
        {% endif %}
    {% endfor %}
  </ul>
</div>
{% elif unit_topics %}
    <h3>Unit Resources</h3>
    <p>
        Under topic resources you will find more general resources that
        are too broad for a single unit topic.
    </p>
    <p>
        <a href="{% url 'uploader:unit_resources' unit.syllabus.subject.slug unit.syllabus.slug unit.syllabus.exam_level.slug unit.slug %}">
            View unit resources
        </a>
    </p>
    <br />
    <div id="resouce_list">
        <h3>Unit Topics</h3>
        <!-- As we input data, we can assume that it if the first item has a group, they all do -->
        {% if unit_topics.0.section %}
            {% regroup unit_topics by section as section_list %}
            {% for section in section_list %}
                <h4>{{ section.grouper }}</h4>
                <ul>
                    {% for item in section.list %}
                      <!--<li>{{ item.name }}: {{ item.population }}</li>-->
                      <li><a href="{% url 'uploader:unit_topic' unit.syllabus.subject.slug unit.syllabus.exam_level.slug unit.syllabus.slug unit.slug item.slug %}">{{ item }}</a></li> 
                    {% endfor %}
                </ul>
            {% endfor %}
        {% else %}
            {% if unit_topics %}
            <ul>
            {% for unit_topic in unit_topics %}
              <li><a href="{% url 'uploader:unit_topic' unit.syllabus.subject.slug unit.syllabus.exam_level.slug unit.syllabus.slug unit.slug unit_topic.slug %}">{{ unit_topic.title }}</a></li> 

            {% endfor %}
            </ul>
            {% else %}
            No resources :(
            {% endif %}
        {% endif %}
    </div>
{% else %}
<p>No unit resources or unit topics :(</p>
{% endif %}
{% endblock %}
