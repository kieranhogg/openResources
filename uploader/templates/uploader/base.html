{% load gravatar %}
{% load staticfiles %}
{% load tags %}

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<script src="{% static 'js/jquery.js' %}" type="text/javascript"></script>
<script type="text/javascript"> 
  $(function() {
    moveScroller();
  });
  
  function moveScroller() {
    var move = function() {
        var st = $(window).scrollTop();
        var ot = $("#menu-anchor").offset().top;
        var s = $("#menu");
        if(st > ot) {
            s.css({
                position: "fixed",
                top: "0px"
            });
        } else {
            if(st <= ot) {
                s.css({
                    position: "relative",
                    top: ""
                });
            }
        }
    };
    $(window).scroll(move);
    move();
}
</script>
<link rel="stylesheet" type="text/css" href="{% static 'uploader/style.css' %}" />
<link rel="stylesheet" type="text/css" media="only screen and (max-width: 480px), only screen and (max-device-width: 480px)" href="{% static 'uploader/small-devices.css' %}" />
<title>{{ SITE_NAME }} | {% block head_title %}{% endblock %}</title>
<link rel="shortcut icon" type="image/png" href="{{STATIC_URL}}/favicon.ico" />
</head>
<body>
<div id="container">
    <div id="header">
        <div id="logo">
            <a href="{% url 'uploader:index' %}">
            <img src="{% static 'uploader/logo_s.png' %}" alt="logo" width="64" height="64" />
            <h1>{{ SITE_NAME }}</h1>
            </a>
        </div>
        {% try_to_include "uploader/top_banner.html" %}
        <div id="login">
                <div id='login_links'>
            {% if user.is_authenticated %}
                <span id='user_icon'>
                <a href="{% url 'uploader:profile' %}">
                    <img src="{% gravatar_url user.email 24 %}" />
                </span>
                    <span id='username'>{{ user.get_username }}</span>
                </a>
                <span id="score">
                {% if user.teacherprofile %}
                ({{ user.teacherprofile.score }})
                {% elif user.studentprofile %}
                ({{ user.studentprofile.score }})
                {% endif %}
                </span>
                | <a href="{% url 'account_logout' %}">Sign Out</a>
                </p>
            {% else %}
                <a href="{% url 'account_login' %}">Sign In</a> or 
                <a href="{% url 'uploader:signup' %}">Sign Up</a></p>
            {% endif %}
                </div>
        </div>
        <div id="search">
            <!--Search-->
        </div>
    </div>
    <div id="menu-anchor"></div>
    <div id="menu">
        <ul>
            <!--<li id="menu_home">-->
            <!--    <a href="{% url 'uploader:index' %}">-->
            <!--    <img class="menu_icon" src="{% static 'uploader/img/18x18/home.png' %}" height="18" width="18"/>-->
            <!--    <span class="menu_text">Home</span>-->
            <!--    </a>-->
            <!--</li>-->
            <li id="menu_submit"><a href="{% url 'uploader:add_resource' %}">
                <img class="menu_icon" src="{% static 'uploader/img/18x18/upload.png' %}" height="18" width="18"/>
                <span class="menu_text">Add Resource</span>
                </a>
            </li>
            {% if user.teacherprofile %}
            <li id="menu_my_resources"><a href="javascript:void(0)">
                <img class="menu_icon" src="{% static 'uploader/img/18x18/folder.png' %}" height="18" width="18"/>
                <span class="menu_text">My Folder</span>
                </a>
                <ul>
                    <a href="{% url 'uploader:user_resources' %}"><li>
                        <img class="menu_icon" src="{% static 'uploader/img/18x18/download.png' %}" height="18" width="18"/>
                <span class="menu_text">
                        Resources</span></li></a>
                <a href="{% url 'uploader:user_files' %}"><li>
                        <img class="menu_icon" src="{% static 'uploader/img/18x18/files.png' %}" height="18" width="18"/>
                <span class="menu_text">Files</span></li></a>
                <a href="{% url 'uploader:user_bookmarks' %}"><li>
                        <img class="menu_icon" src="{% static 'uploader/img/18x18/bookmark.png' %}" height="18" width="18"/>
                <span class="menu_text">Bookmarks</span></li></a>
                <!--    <a href="javascript:void(0)"><li>-->
                <!--        <img class="menu_icon" src="{% static 'uploader/img/18x18/book.png' %}" height="18" width="18"/>-->
                <!--<span class="menu_text">Notes</span></li></a>-->
                    <a href="{% url 'uploader:user_questions' %}"><li>
                        <img class="menu_icon" src="{% static 'uploader/img/18x18/speech_bubble.png' %}" height="18" width="18"/>
                <span class="menu_text">Questions</span></li></a>
                    <a href="{% url 'uploader:user_lessons' %}"><li>
                        <img class="menu_icon" src="{% static 'uploader/img/18x18/inbox.png' %}" height="18" width="18"/>
                <span class="menu_text">Lessons</span></li></a>
                </ul>
            </li>
            {% endif %}
            <!--<li id="menu_leaderboards"><a href="{% url 'uploader:leaderboard' %}">-->
            <!--    <img class="menu_icon" src="{% static 'uploader/img/18x18/stats.png' %}" height="18" width="18"/>-->
            <!--    <span class="menu_text">Leaderboards</span>-->
            <!--    </a>-->
            <!--</li>-->
            <li id="menu_about"><a href="{% url 'uploader:about' %}">
                <img class="menu_icon" src="{% static 'uploader/img/18x18/website.png' %}" height="18" width="18"/>
                <span class="menu_text">About</span>
                </a>
            </li>
            <!--<li id="menu_twitter">-->
            <!--    <a href="https://twitter.com/eduresourc_es">-->
            <!--        <img class="menu_icon" src="{% static 'uploader/img/18x18/twitter.png' %}" width="22" height="22" />-->
            <!--        <span class="menu_text">Twitter</span>-->
            <!--    </a>-->
            <!--</li>-->
            <!--<li id="menu_email">-->
            <!--<a href="mailto:contact@eduresourc.es">-->
            <!--    <img class="menu_icon" src="{% static 'uploader/img/18x18/email.png' %}" width="18" height="18" />-->
            <!--</a>-->
            <!--</li>-->
            {% if user.is_superuser or user.is_staff %}
            <li id="admin_button"><a href="/admin/">
                 <img class="menu_icon" src="{% static 'uploader/img/18x18/settings.png' %}" height="18" width="18"/>
                <span class="menu_text">Admin</span>
                </a>
            </li>
            {% endif %}
        </ul>
    </div>
    <div id="content">
        {% if user_messages %}
            {% for message in user_messages %}
                <div class="{{ message.get_type_display }}">
                {% if message.get_type_display == "Sticky" %}
                    {{ message|safe }}
                {% elif message.get_type_display == "Announcement" %}
                    {{ message|safe }}
                    <div class="message_dismiss">[X]</div>
                {% else %}
                    {{ message }}
                    <div class="message_dismiss">[X]</div>
                {% endif %}
                </div>
            {% endfor %}
        {% endif %}
        
        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
            <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% block body_block %}{% endblock %}
    </div>
    <div id="footer">
        <p>
        Powered by <a href="https://github.com/xerosis/openResources">openResources</a> 
        v{{ APP_VERSION}}.
        </p>
    </div>

</div>
</body>
</html>
